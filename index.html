<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Wiksxz Store | Premium Shop</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;500;700&display=swap');
        
        :root {
            --bg: #010409;
            --accent: #00d2ff;
            --premium: #ffb800;
            --success: #00ff88;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            margin: 0; background: var(--bg); color: #fff;
            font-family: 'Inter', sans-serif; overflow-x: hidden;
        }

        /* Навигация */
        nav {
            background: var(--glass); backdrop-filter: blur(10px);
            padding: 15px 20px; display: flex; justify-content: space-between;
            align-items: center; border-bottom: 1px solid var(--glass-border);
            position: sticky; top: 0; z-index: 100;
        }

        .logo { font-family: 'Orbitron'; color: var(--accent); font-weight: bold; font-size: 20px; }

        .profile-btn {
            background: var(--accent); color: #000; border: none;
            padding: 8px 15px; border-radius: 8px; font-weight: bold; cursor: pointer;
        }

        /* Магазин */
        .container { width: 100%; max-width: 900px; margin: 0 auto; padding: 20px; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px; }
        
        .card {
            background: var(--glass); border: 1px solid var(--glass-border);
            border-radius: 24px; padding: 25px; text-align: center;
            transition: 0.3s;
        }
        .card:hover { transform: translateY(-5px); border-color: var(--accent); }

        .robux-icon { width: 50px; height: 50px; fill: var(--premium); margin-bottom: 15px; }

        .price { font-size: 20px; font-weight: bold; color: var(--success); margin: 10px 0; }

        .buy-btn {
            width: 100%; padding: 12px; border: none; border-radius: 12px;
            background: rgba(255,255,255,0.05); color: #fff; cursor: pointer;
            border: 1px solid var(--glass-border);
        }
        .buy-btn.active { background: var(--accent); color: #000; }

        /* Модальное окно профиля */
        .modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            display: none; align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-content {
            background: #0d1117; width: 90%; max-width: 350px;
            padding: 30px; border-radius: 25px; border: 1px solid var(--glass-border);
            text-align: center; position: relative;
        }

        .input-box { position: relative; margin: 15px 0; text-align: left; }
        input {
            width: 100%; padding: 12px; background: #000; border: 1px solid var(--glass-border);
            border-radius: 10px; color: #fff; outline: none; box-sizing: border-box;
        }

        #search-results {
            position: absolute; top: 100%; left: 0; right: 0;
            background: #161b22; border: 1px solid var(--glass-border);
            border-radius: 10px; max-height: 150px; overflow-y: auto;
            z-index: 110; display: none;
        }

        .user-item {
            display: flex; align-items: center; gap: 10px; padding: 8px;
            cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .user-item:hover { background: var(--accent); color: #000; }
        .user-item img { width: 30px; height: 30px; border-radius: 50%; }

        .close-modal { position: absolute; top: 15px; right: 15px; cursor: pointer; opacity: 0.5; }

        #user-badge { display: none; align-items: center; gap: 10px; background: rgba(0,255,136,0.1); padding: 5px 12px; border-radius: 20px; color: var(--success); font-size: 14px; }
    </style>
</head>
<body>

<nav>
    <div class="logo">WIKSXZ</div>
    <div id="user-badge"></div>
    <button class="profile-btn" id="p-btn" onclick="toggleModal()">Профиль</button>
</nav>

<div class="container">
    <h1 style="text-align: center; font-family: 'Orbitron';">МАГАЗИН</h1>
    
    <div class="grid">
        <div class="card">
            <svg class="robux-icon" viewBox="0 0 45 45"><path d="M22.5 0L42.0642 11.25V33.75L22.5 45L2.93583 33.75V11.25L22.5 0Z"/></svg>
            <h3>400 R$</h3>
            <div class="price">420 сом</div>
            <button class="buy-btn" onclick="addToCart(400)">В корзину</button>
        </div>
        <div class="card">
            <svg class="robux-icon" viewBox="0 0 45 45"><path d="M22.5 0L42.0642 11.25V33.75L22.5 45L2.93583 33.75V11.25L22.5 0Z"/></svg>
            <h3>800 R$</h3>
            <div class="price":>830 сом</div>
            <button class="buy-btn" onclick="addToCart(800)">В корзину</button>
        </div>
    </div>
</div>

<div class="modal" id="auth-modal">
    <div class="modal-content">
        <i class="fas fa-times close-modal" onclick="toggleModal()"></i>
        <h3 style="font-family: 'Orbitron'; color: var(--accent);">АККАУНТ</h3>
        
        <div class="input-box">
            <input type="text" id="rbx-search" placeholder="Ник в Roblox" autocomplete="off">
            <div id="search-results"></div>
        </div>
        
        <div class="input-box">
            <input type="password" id="pass-field" placeholder="Придумайте пароль">
        </div>

        <button class="profile-btn" style="width: 100%; margin-top: 10px;" onclick="saveProfile()">СОХРАНИТЬ</button>
    </div>
</div>

<script>
    const searchInput = document.getElementById('rbx-search');
    const resultsBox = document.getElementById('search-results');
    let isAuth = false;
    let selectedUserData = null;

    // Функция открытия модалки
    function toggleModal() {
        const m = document.getElementById('auth-modal');
        m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
    }

    // Поиск игроков (с использованием CORS-прокси для локального запуска)
    searchInput.addEventListener('input', async () => {
        const q = searchInput.value;
        if(q.length < 3) { resultsBox.style.display = 'none'; return; }

        try {
            // Используем прокси, чтобы работало на локальном файле
            const res = await fetch(`https://corsproxy.io/?https://users.roblox.com/v1/users/search?keyword=${q}&limit=5`);
            const data = await res.json();
            
            if(data.data && data.data.length > 0) {
                resultsBox.innerHTML = '';
                resultsBox.style.display = 'block';
                data.data.forEach(user => {
                    const div = document.createElement('div');
                    div.className = 'user-item';
                    const img = `https://www.roblox.com/headshot-thumbnail/image?userId=${user.id}&width=48&height=48&format=png`;
                    div.innerHTML = `<img src="${img}"> <span>${user.name}</span>`;
                    div.onclick = () => {
                        selectedUserData = user;
                        searchInput.value = user.name;
                        searchInput.style.borderColor = "var(--success)";
                        resultsBox.style.display = 'none';
                    };
                    resultsBox.appendChild(div);
                });
            }
        } catch(e) { console.log("Ошибка API. Попробуйте позже или включите VPN"); }
    });

    // Сохранение профиля
    function saveProfile() {
        const pass = document.getElementById('pass-field').value;
        if(!selectedUserData || pass.length < 4) {
            alert("Выберите игрока из списка и введите пароль!");
            return;
        }

        localStorage.setItem('user', JSON.stringify(selectedUserData));
        localStorage.setItem('auth', 'true');
        location.reload();
    }

    // Логика корзины
    function addToCart(amount) {
        if(localStorage.getItem('auth') !== 'true') {
            alert("❌ Ошибка: Для покупки нужно войти в Профиль!");
            toggleModal();
        } else {
            alert(`✅ ${amount} R$ добавлены в корзину!`);
        }
    }

    // Проверка при загрузке
    window.onload = () => {
        if(localStorage.getItem('auth') === 'true') {
            const user = JSON.parse(localStorage.getItem('user'));
            document.getElementById('p-btn').style.display = 'none';
            const badge = document.getElementById('user-badge');
            badge.style.display = 'flex';
            badge.innerHTML = `<i class="fas fa-check-circle"></i> ${user.name}`;
            
            // Делаем кнопки яркими
            document.querySelectorAll('.buy-btn').forEach(btn => btn.classList.add('active'));
        }
    }
</script>

</body>
</html>

